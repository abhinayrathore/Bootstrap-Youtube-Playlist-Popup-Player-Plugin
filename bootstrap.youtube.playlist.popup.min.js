/*!
 * Bootstrap YouTube Playlist Popup Player Plugin
 * http://lab.abhinayrathore.com/bootstrap-youtube-playlist-popup/
 * https://github.com/abhinayrathore/Bootstrap-Youtube-Playlist-Popup-Player-Plugin
 */
!function(t,o,e){function i(o,e){var i=["https://www.googleapis.com/youtube/v3/videos?id=",o,"&maxResults=50","&part=snippet","&fields=items(snippet(title))","&key=",m.apiKey].join("");t.ajax({url:i,dataType:"json",cache:!0,success:function(t){e.call(this,o,t)}})}var n=null,l=null,s=null,a=null,d=null,u=null,p=null,c=null,r=null,y=4,b=null,h=!1,f=[],v={},m=null;if(o.YT)h=!0;else{var g=e.createElement("script"),P=e.getElementsByTagName("script")[0];g.src="//www.youtube.com/iframe_api",P.parentNode.insertBefore(g,P),o.onYouTubeIframeAPIReady=function(){h=!0}}var T={init:function(o){return o=t.extend({},t.fn.YouTubePlaylistModal.defaults,o),n||(n=t('<div class="modal fade '+o.cssClass+'" id="YouTubePlaylistModal" role="dialog" aria-hidden="true">'),n.html(r.createMarkup(o)).hide().appendTo("body"),l=t("#YouTubePlaylistModalDialog"),s=t("#YouTubePlaylistModalTitle"),a=t("#YouTubePlaylistModalBody"),n.modal({show:!1}).on("show.bs.modal",function(){o.onOpen&&o.onOpen()}).on("hide.bs.modal",function(){r.onClose(),o.onClose&&o.onClose()})),this.each(function(){var e=t(this),i=e.data("YouTubePlaylist");i||(e.data("YouTubePlaylist",!0),t(e).bind("click.YouTubePlaylistModal",function(){m=o,f=o.playList,(!(f instanceof Array)||f.length<1)&&(f=e.data("playlist").split(",")),o.title&&r.setTitle(o.title),f=t.grep(f,function(t){return t}),r.resize(o.width),h?f&&f instanceof Array&&f.length?u.init(o):f&&f instanceof Array&&f.length||r.setTitle(o.errors.no_ids):r.setTitle(o.errors.no_api),n.modal("show")}))})},destroy:function(){return this.each(function(){t(this).unbind(".YouTubePlaylistModal").removeData("YouTubePlaylist")})}};r={createMarkup:function(t){return['<div class="modal-dialog" id="YouTubePlaylistModalDialog">','<div class="modal-content" id="YouTubePlaylistModalContent">','<div class="modal-header">','<button type="button" class="close" data-dismiss="modal">&times;</button>','<h4 class="modal-title" id="YouTubePlaylistModalTitle"></h4>',"</div>",'<div class="modal-body" id="YouTubePlaylistModalBody" style="padding:0;"><div style="margin: ',y,'px;" id="YouTubePlaylistPlayer"></div></div>','<div class="modal-footer" style="text-align: center;">','<button type="button" class="btn btn-default btn-sm" data-dismiss="modal" aria-label="',t.translations.close,'" title="',t.translations.close,'"><span class="',t.icons.close,'"></span></button>','<button type="button" class="btn btn-default btn-sm mute-video" aria-label="',t.translations.mute,'" title="',t.translations.mute,'"><span class="',t.icons.mute,'"></span></button>','<button type="button" class="btn btn-default btn-sm first-video" aria-label="',t.translations.first,'" title="',t.translations.first,'"><span class="',t.icons.first,'"></span></button>','<button type="button" class="btn btn-default btn-sm prev-video" aria-label="',t.translations.prev,'" title="',t.translations.prev,'"><span class="',t.icons.prev,'"></span></button>','<button type="button" class="btn btn-default btn-sm play-video" aria-label="',t.translations.play,'" title="',t.translations.play,'"><span class="',t.icons.play,'"></span></button>','<button type="button" class="btn btn-default btn-sm pause-video hidden" aria-label="',t.translations.pause,'" title="',t.translations.pause,'"><span class="',t.icons.pause,'"></span></button>','<button type="button" class="btn btn-default btn-sm next-video" aria-label="',t.translations.next,'" title="',t.translations.next,'"><span class="',t.icons.next,'"></span></button>','<button type="button" class="btn btn-default btn-sm last-video" aria-label="',t.translations.last,'" title="',t.translations.last,'"><span class="',t.icons.last,'"></span></button>','<button type="button" class="btn btn-default btn-sm shuffle-video" aria-label="',t.translations.shuffle,'" title="',t.translations.shuffle,'"><span class="',t.icons.shuffle,'"></span></button>','<button type="button" class="btn btn-default btn-sm loop-video" aria-label="',t.translations.loop,'" title="',t.translations.loop,'"><span class="',t.icons.loop,'"></span></button>','<button type="button" class="btn btn-default btn-sm stop-video" aria-label="',t.translations.stop,'" title="',t.translations.stop,'"><span class="',t.icons.stop,'"></span></button>','<button type="button" class="btn btn-default btn-sm list-video" data-toggle="popover" data-placement="top" aria-label="',t.translations.list,'" title="',t.translations.list,'"><span class="',t.icons.list,'"></span></button>','<div class="list-popover-content hidden"></div>',"</div>","</div>","</div>"].join("")},setTitle:function(o){s.html(t.trim(o))},setTitleById:function(t){v[t]&&v[t].title?this.setTitle(v[t].title):i(t,function(t,o){o&&o.items&&o.items[0].snippet.title&&r.setTitle(o.items[0].snippet.title)})},reset:function(){this.setTitle("")},resize:function(t){l.css({width:t+2*y+2})},onClose:function(){f=[],v={},c.destroy(),t("#list-popover-content").empty(),b&&b.destroy(),p.unbind(),r.reset()}},u={init:function(t){b=new YT.Player("YouTubePlaylistPlayer",{height:t.height,width:t.width,videoId:f[0],playerVars:{autohide:t.autohide,autoplay:t.autoplay,color:t.color,controls:t.controls,fs:t.fs,loop:t.loop,modestbranding:t.modestbranding,origin:o.location.hostname,showinfo:t.showinfo,theme:t.theme},events:{onReady:this.onPlayerReady,onStateChange:this.onPlayerStateChange}})},onPlayerReady:function(t){c.init(),t.target.cuePlaylist({playlist:f}),m.autoplay&&t.target.playVideo(),p.init()},onPlayerStateChange:function(t){if(!m.title){var o=b.getPlaylistIndex();o>-1&&r.setTitleById(f[o])}}},p={init:function(){m.autoplay&&n.find(".pause-video, .play-video").toggleClass("hidden"),n.on("click",".first-video",function(){b.playVideoAt(0)}),n.on("click",".prev-video",function(){b.previousVideo()}),n.on("click",".play-video",function(){b.playVideo(),t(this).addClass("hidden"),n.find(".pause-video").removeClass("hidden")}),n.on("click",".pause-video",function(){b.pauseVideo(),t(this).addClass("hidden"),n.find(".play-video").removeClass("hidden")}),n.on("click",".next-video",function(){b.nextVideo()}),n.on("click",".last-video",function(){b.playVideoAt(f.length-1)}),n.on("click",".shuffle-video",function(){b.setShuffle(!t(this).hasClass("active")),t(this).toggleClass("active")}),n.on("click",".loop-video",function(){b.setLoop(!t(this).hasClass("active")),t(this).toggleClass("active")}),n.on("click",".stop-video",function(){b.stopVideo()}),n.on("click",".mute-video",function(){t(this).hasClass("active")?b.unMute():b.mute(),t(this).toggleClass("active")}),n.on("click",".popover-video-link",function(){return b.playVideoAt(t(this).data("index")),d.popover("hide"),!1})},unbind:function(){n.off("click",'[class$="-video"]')}},c={init:function(){d=n.find(".list-video"),d.popover({html:!0,content:function(t){return['<div style="max-height: ',m.height,'px; overflow-y: auto;">',n.find(".list-popover-content").html(),"</div>"].join("")}}).popover("hide"),this.setupPlaylistObject()},setupPlaylistObject:function(){var o,e,l,s=n.find(".list-popover-content");for(s.empty(),e=0,len=f.length;e<len;e++)o=t.trim(f[e]),l=o,v[o]={},s.append(['<div class="media" style="overflow: hidden; text-overflow: ellipsis;">','<a class="pull-left popover-video-link" data-index="'+e+'" data-id="'+o+'" href="#">','<img class="media-object" src="//i.ytimg.com/vi/'+o+'/default.jpg" alt="'+l+'" height="50" />',"</a>",'<div class="media-body">','<a class="pull-left popover-video-link" data-index="'+e+'" data-id="'+o+'" href="#">','<h5 class="media-heading">'+l+"</h5>","</a>","</div>","</div>"].join("")),i(o,this.populatePopoverList)},populatePopoverList:function(t,o){var e=n.find(".list-popover-content");o&&o.items&&o.items[0].snippet.title&&(v[t]=v[t]||{},v[t].title=o.items[0].snippet.title,v[t].desc=o.items[0].snippet.title,e.find('.popover-video-link[data-id="'+t+'"] > h5').html(v[t].title),e.find('.popover-video-link[data-id="'+t+'"]').attr("title",v[t].desc))},destroy:function(){d&&d.popover("destroy")}},t.fn.YouTubePlaylistModal=function(o){return T[o]?T[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void t.error("Method "+o+" does not exist on Bootstrap.YouTubePlaylistModal"):T.init.apply(this,arguments)},t.fn.YouTubePlaylistModal.defaults={playList:"",title:"",apiKey:"",cssClass:"YouTubePlaylistModal",width:640,height:480,autohide:2,autoplay:1,color:"red",controls:1,fs:1,loop:0,modestbranding:1,showinfo:0,theme:"light",icons:{close:"glyphicon glyphicon-remove",first:"glyphicon glyphicon-fast-backward",prev:"glyphicon glyphicon-step-backward",play:"glyphicon glyphicon-play",pause:"glyphicon glyphicon-pause",next:"glyphicon glyphicon-step-forward",last:"glyphicon glyphicon-fast-forward",stop:"glyphicon glyphicon-stop",shuffle:"glyphicon glyphicon-random",loop:"glyphicon glyphicon-repeat",mute:"glyphicon glyphicon-volume-off",list:"glyphicon glyphicon-list"},translations:{close:"Close",first:"First",prev:"Previous",play:"Play",pause:"Pause",next:"Next",last:"Last",stop:"Stop",shuffle:"Shuffle",loop:"Loop",mute:"Mute",list:"Playlist"},errors:{no_api:"YouTube API not initialized!",no_ids:"No videos added to playlist!"},onOpen:null,onClose:null}}(jQuery,window,document);
